<!DOCTYPE html><html lang="en"><head><title>assets/scripts/vendor/backbone_validation</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../../../"><meta name="groc-document-path" content="assets/scripts/vendor/backbone_validation"><meta name="groc-project-path" content="assets/scripts/vendor/backbone_validation.js"><link rel="stylesheet" type="text/css" media="all" href="../../../assets/style.css"><script type="text/javascript" src="../../../assets/behavior.js"></script><body><div id="meta"><div class="file-path">assets/scripts/vendor/backbone_validation.js</div></div><div id="document"><div class="segment"><div class="code"><div class="wrapper">Backbone.Validation = (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(_)</span>{</span>
<span class="hljs-pi">  'use strict'</span>;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="default-options">Default options</h2></div></div></div><div class="segment"><div class="code"><div class="wrapper">  <span class="hljs-keyword">var</span> defaultOptions = {
    forceUpdate: <span class="hljs-literal">false</span>,
    selector: <span class="hljs-string">'name'</span>,
    labelFormatter: <span class="hljs-string">'sentenceCase'</span>,
    valid: <span class="hljs-built_in">Function</span>.prototype,
    invalid: <span class="hljs-built_in">Function</span>.prototype
  };</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="helper-functions">Helper functions</h2></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Formatting functions used for formatting error messages</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-keyword">var</span> formatFunctions = {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Uses the configured label formatter to format the attribute name
to make it more readable for the user</p></div></div><div class="code"><div class="wrapper">    formatLabel: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(attrName, model)</span> {</span>
      <span class="hljs-keyword">return</span> defaultLabelFormatters[defaultOptions.labelFormatter](attrName, model);
    },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Replaces nummeric placeholders like {0} in a string with arguments
passed to the function</p></div></div><div class="code"><div class="wrapper">    format: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
      <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>),
          text = args.shift();
      <span class="hljs-keyword">return</span> text.replace(<span class="hljs-regexp">/\{(\d+)\}/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(match, number)</span> {</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> args[number] !== <span class="hljs-string">'undefined'</span> ? args[number] : match;
      });
    }
  };</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Flattens an object
eg:
    var o = {
      address: {
        street: &#39;Street&#39;,
        zip: 1234
      }
    };
becomes:
    var o = {
      &#39;address.street&#39;: &#39;Street&#39;,
      &#39;address.zip&#39;: 1234
    };</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-keyword">var</span> flatten = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj, into, prefix)</span> {</span>
    into = into || {};
    prefix = prefix || <span class="hljs-string">''</span>;

    _.each(obj, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(val, key)</span> {</span>
      <span class="hljs-keyword">if</span>(obj.hasOwnProperty(key)) {
        <span class="hljs-keyword">if</span> (val &amp;&amp; <span class="hljs-keyword">typeof</span> val === <span class="hljs-string">'object'</span> &amp;&amp; !(
          val <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Array</span> ||
          val <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Date</span> ||
          val <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">RegExp</span> ||
          val <span class="hljs-keyword">instanceof</span> Backbone.Model ||
          val <span class="hljs-keyword">instanceof</span> Backbone.Collection)
        ) {
          flatten(val, into, prefix + key + <span class="hljs-string">'.'</span>);
        }
        <span class="hljs-keyword">else</span> {
          into[prefix + key] = val;
        }
      }
    });

    <span class="hljs-keyword">return</span> into;
  };</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="validation">Validation</h2></div></div></div><div class="segment"><div class="code"><div class="wrapper">  <span class="hljs-keyword">var</span> Validation = (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Returns an object with undefined properties for all
attributes on the model that has defined one or more
validation rules.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">var</span> getValidatedAttrs = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(model)</span> {</span>
      <span class="hljs-keyword">return</span> _.reduce(_.keys(_.result(model, <span class="hljs-string">'validation'</span>) || {}), <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(memo, key)</span> {</span>
        memo[key] = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;
        <span class="hljs-keyword">return</span> memo;
      }, {});
    };</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Looks on the model for validations for a specified
attribute. Returns an array of any validators defined,
or an empty array if none is defined.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">var</span> getValidators = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(model, attr)</span> {</span>
      <span class="hljs-keyword">var</span> attrValidationSet = model.validation ? _.result(model, <span class="hljs-string">'validation'</span>)[attr] || {} : {};</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>If the validator is a function or a string, wrap it in a function validator</p></div></div><div class="code"><div class="wrapper">      <span class="hljs-keyword">if</span> (_.isFunction(attrValidationSet) || _.isString(attrValidationSet)) {
        attrValidationSet = {
          fn: attrValidationSet
        };
      }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Stick the validator object into an array</p></div></div><div class="code"><div class="wrapper">      <span class="hljs-keyword">if</span>(!_.isArray(attrValidationSet)) {
        attrValidationSet = [attrValidationSet];
      }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Reduces the array of validators into a new array with objects
with a validation method to call, the value to validate against
and the specified error message, if any</p></div></div><div class="code"><div class="wrapper">      <span class="hljs-keyword">return</span> _.reduce(attrValidationSet, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(memo, attrValidation)</span> {</span>
        _.each(_.without(_.keys(attrValidation), <span class="hljs-string">'msg'</span>), <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(validator)</span> {</span>
          memo.push({
            fn: defaultValidators[validator],
            val: attrValidation[validator],
            msg: attrValidation.msg
          });
        });
        <span class="hljs-keyword">return</span> memo;
      }, []);
    };</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Validates an attribute against all validators defined
for that attribute. If one or more errors are found,
the first error message is returned.
If the attribute is valid, an empty string is returned.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">var</span> validateAttr = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(model, attr, value, computed)</span> {</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Reduces the array of validators to an error message by
applying all the validators and returning the first error
message, if any.</p></div></div><div class="code"><div class="wrapper">      <span class="hljs-keyword">return</span> _.reduce(getValidators(model, attr), <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(memo, validator)</span>{</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Pass the format functions plus the default
validators as the context to the validator</p></div></div><div class="code"><div class="wrapper">        <span class="hljs-keyword">var</span> ctx = _.extend({}, formatFunctions, defaultValidators),
            result = validator.fn.call(ctx, value, attr, validator.val, model, computed);

        <span class="hljs-keyword">if</span>(result === <span class="hljs-literal">false</span> || memo === <span class="hljs-literal">false</span>) {
          <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
        <span class="hljs-keyword">if</span> (result &amp;&amp; !memo) {
          <span class="hljs-keyword">return</span> _.result(validator, <span class="hljs-string">'msg'</span>) || result;
        }
        <span class="hljs-keyword">return</span> memo;
      }, <span class="hljs-string">''</span>);
    };</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Loops through the model&#39;s attributes and validates them all.
Returns and object containing names of invalid attributes
as well as error messages.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">var</span> validateModel = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(model, attrs)</span> {</span>
      <span class="hljs-keyword">var</span> error,
          invalidAttrs = {},
          isValid = <span class="hljs-literal">true</span>,
          computed = _.clone(attrs),
          flattened = flatten(attrs);

      _.each(flattened, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(val, attr)</span> {</span>
        error = validateAttr(model, attr, val, computed);
        <span class="hljs-keyword">if</span> (error) {
          invalidAttrs[attr] = error;
          isValid = <span class="hljs-literal">false</span>;
        }
      });

      <span class="hljs-keyword">return</span> {
        invalidAttrs: invalidAttrs,
        isValid: isValid
      };
    };</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Contains the methods that are mixed in on the model when binding</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">var</span> mixin = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(view, options)</span> {</span>
      <span class="hljs-keyword">return</span> {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Check whether or not a value, or a hash of values
passes validation without updating the model</p></div></div><div class="code"><div class="wrapper">        preValidate: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(attr, value)</span> {</span>
          <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
              result = {},
              error;

          <span class="hljs-keyword">if</span>(_.isObject(attr)){
            _.each(attr, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(value, key)</span> {</span>
              error = self.preValidate(key, value);
              <span class="hljs-keyword">if</span>(error){
                result[key] = error;
              }
            });

            <span class="hljs-keyword">return</span> _.isEmpty(result) ? <span class="hljs-literal">undefined</span> : result;
          }
          <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> validateAttr(<span class="hljs-keyword">this</span>, attr, value, _.extend({}, <span class="hljs-keyword">this</span>.attributes));
          }
        },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Check to see if an attribute, an array of attributes or the
entire model is valid. Passing true will force a validation
of the model.</p></div></div><div class="code"><div class="wrapper">        isValid: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(option)</span> {</span>
          <span class="hljs-keyword">var</span> flattened = flatten(<span class="hljs-keyword">this</span>.attributes);

          <span class="hljs-keyword">if</span>(_.isString(option)){
            <span class="hljs-keyword">return</span> !validateAttr(<span class="hljs-keyword">this</span>, option, flattened[option], _.extend({}, <span class="hljs-keyword">this</span>.attributes));
          }
          <span class="hljs-keyword">if</span>(_.isArray(option)){
            <span class="hljs-keyword">return</span> _.reduce(option, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(memo, attr)</span> {</span>
              <span class="hljs-keyword">return</span> memo &amp;&amp; !validateAttr(<span class="hljs-keyword">this</span>, attr, flattened[attr], _.extend({}, <span class="hljs-keyword">this</span>.attributes));
            }, <span class="hljs-literal">true</span>, <span class="hljs-keyword">this</span>);
          }
          <span class="hljs-keyword">if</span>(option === <span class="hljs-literal">true</span>) {
            <span class="hljs-keyword">this</span>.validate();
          }
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.validation ? <span class="hljs-keyword">this</span>._isValid : <span class="hljs-literal">true</span>;
        },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>This is called by Backbone when it needs to perform validation.
You can call it manually without any parameters to validate the
entire model.</p></div></div><div class="code"><div class="wrapper">        validate: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(attrs, setOptions)</span>{</span>
          <span class="hljs-keyword">var</span> model = <span class="hljs-keyword">this</span>,
              validateAll = !attrs,
              opt = _.extend({}, options, setOptions),
              validatedAttrs = getValidatedAttrs(model),
              allAttrs = _.extend({}, validatedAttrs, model.attributes, attrs),
              changedAttrs = flatten(attrs || allAttrs),

              result = validateModel(model, allAttrs);

          model._isValid = result.isValid;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>After validation is performed, loop through all validated attributes
and call the valid callbacks so the view is updated.</p></div></div><div class="code"><div class="wrapper">          _.each(validatedAttrs, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(val, attr)</span>{</span>
            <span class="hljs-keyword">var</span> invalid = result.invalidAttrs.hasOwnProperty(attr);
            <span class="hljs-keyword">if</span>(!invalid){
              opt.valid(view, attr, opt.selector);
            }
          });</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>After validation is performed, loop through all validated and changed attributes
and call the invalid callback so the view is updated.</p></div></div><div class="code"><div class="wrapper">          _.each(validatedAttrs, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(val, attr)</span>{</span>
            <span class="hljs-keyword">var</span> invalid = result.invalidAttrs.hasOwnProperty(attr),
                changed = changedAttrs.hasOwnProperty(attr);

            <span class="hljs-keyword">if</span>(invalid &amp;&amp; (changed || validateAll)){
              opt.invalid(view, attr, result.invalidAttrs[attr], opt.selector);
            }
          });</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Trigger validated events.
Need to defer this so the model is actually updated before
the event is triggered.</p></div></div><div class="code"><div class="wrapper">          _.defer(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
            model.trigger(<span class="hljs-string">'validated'</span>, model._isValid, model, result.invalidAttrs);
            model.trigger(<span class="hljs-string">'validated:'</span> + (model._isValid ? <span class="hljs-string">'valid'</span> : <span class="hljs-string">'invalid'</span>), model, result.invalidAttrs);
          });</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Return any error messages to Backbone, unless the forceUpdate flag is set.
Then we do not return anything and fools Backbone to believe the validation was
a success. That way Backbone will update the model regardless.</p></div></div><div class="code"><div class="wrapper">          <span class="hljs-keyword">if</span> (!opt.forceUpdate &amp;&amp; _.intersection(_.keys(result.invalidAttrs), _.keys(changedAttrs)).length &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> result.invalidAttrs;
          }
        }
      };
    };</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Helper to mix in validation on a model</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">var</span> bindModel = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(view, model, options)</span> {</span>
      _.extend(model, mixin(view, options));
    };</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Removes the methods added to a model</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">var</span> unbindModel = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(model)</span> {</span>
      <span class="hljs-keyword">delete</span> model.validate;
      <span class="hljs-keyword">delete</span> model.preValidate;
      <span class="hljs-keyword">delete</span> model.isValid;
    };</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Mix in validation on a model whenever a model is
added to a collection</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">var</span> collectionAdd = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(model)</span> {</span>
      bindModel(<span class="hljs-keyword">this</span>.view, model, <span class="hljs-keyword">this</span>.options);
    };</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Remove validation from a model whenever a model is
removed from a collection</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">var</span> collectionRemove = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(model)</span> {</span>
      unbindModel(model);
    };</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Returns the public methods on Backbone.Validation</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">return</span> {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Current version of the library</p></div></div><div class="code"><div class="wrapper">      version: <span class="hljs-string">'0.9.0'</span>,</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Called to configure the default options</p></div></div><div class="code"><div class="wrapper">      configure: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> {</span>
        _.extend(defaultOptions, options);
      },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Hooks up validation on a view with a model
or collection</p></div></div><div class="code"><div class="wrapper">      bind: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(view, options)</span> {</span>
        options = _.extend({}, defaultOptions, defaultCallbacks, options);

        <span class="hljs-keyword">var</span> model = options.model || view.model,
            collection = options.collection || view.collection;

        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> model === <span class="hljs-string">'undefined'</span> &amp;&amp; <span class="hljs-keyword">typeof</span> collection === <span class="hljs-string">'undefined'</span>){
          <span class="hljs-keyword">throw</span> <span class="hljs-string">'Before you execute the binding your view must have a model or a collection.\n'</span> +
                <span class="hljs-string">'See http://thedersen.com/projects/backbone-validation/#using-form-model-validation for more information.'</span>;
        }

        <span class="hljs-keyword">if</span>(model) {
          bindModel(view, model, options);
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(collection) {
          collection.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(model)</span>{</span>
            bindModel(view, model, options);
          });
          collection.bind(<span class="hljs-string">'add'</span>, collectionAdd, {view: view, options: options});
          collection.bind(<span class="hljs-string">'remove'</span>, collectionRemove);
        }
      },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Removes validation from a view with a model
or collection</p></div></div><div class="code"><div class="wrapper">      unbind: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(view, options)</span> {</span>
        options = _.extend({}, options);
        <span class="hljs-keyword">var</span> model = options.model || view.model,
            collection = options.collection || view.collection;

        <span class="hljs-keyword">if</span>(model) {
          unbindModel(model);
        }
        <span class="hljs-keyword">if</span>(collection) {
          collection.each(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(model)</span>{</span>
            unbindModel(model);
          });
          collection.unbind(<span class="hljs-string">'add'</span>, collectionAdd);
          collection.unbind(<span class="hljs-string">'remove'</span>, collectionRemove);
        }
      },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Used to extend the Backbone.Model.prototype
with validation</p></div></div><div class="code"><div class="wrapper">      mixin: mixin(<span class="hljs-literal">null</span>, defaultOptions)
    };
  }());</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="callbacks">Callbacks</h2></div></div></div><div class="segment"><div class="code"><div class="wrapper">  <span class="hljs-keyword">var</span> defaultCallbacks = Validation.callbacks = {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Gets called when a previously invalid field in the
view becomes valid. Removes any error message.
Should be overridden with custom functionality.</p></div></div><div class="code"><div class="wrapper">    valid: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(view, attr, selector)</span> {</span>
      view.$(<span class="hljs-string">'['</span> + selector + <span class="hljs-string">'~="'</span> + attr + <span class="hljs-string">'"]'</span>)
          .removeClass(<span class="hljs-string">'invalid'</span>)
          .removeAttr(<span class="hljs-string">'data-error'</span>);
    },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Gets called when a field in the view becomes invalid.
Adds a error message.
Should be overridden with custom functionality.</p></div></div><div class="code"><div class="wrapper">    invalid: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(view, attr, error, selector)</span> {</span>
      view.$(<span class="hljs-string">'['</span> + selector + <span class="hljs-string">'~="'</span> + attr + <span class="hljs-string">'"]'</span>)
          .addClass(<span class="hljs-string">'invalid'</span>)
          .attr(<span class="hljs-string">'data-error'</span>, error);
    }
  };</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="patterns">Patterns</h2></div></div></div><div class="segment"><div class="code"><div class="wrapper">  <span class="hljs-keyword">var</span> defaultPatterns = Validation.patterns = {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Matches any digit(s) (i.e. 0-9)</p></div></div><div class="code"><div class="wrapper">    digits: <span class="hljs-regexp">/^\d+$/</span>,</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Matches any number (e.g. 100.000)</p></div></div><div class="code"><div class="wrapper">    number: <span class="hljs-regexp">/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/</span>,</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Matches a valid email address (e.g. mail@example.com)</p></div></div><div class="code"><div class="wrapper">    email: <span class="hljs-regexp">/^((([a-z]|\d|[!#\$%&amp;'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&amp;'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i</span>,</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Mathes any valid url (e.g. <a href="http://www.xample.com">http://www.xample.com</a>)</p></div></div><div class="code"><div class="wrapper">    url: <span class="hljs-regexp">/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&amp;'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&amp;'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&amp;'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&amp;'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&amp;'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i</span>
  };</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="error-messages">Error messages</h2></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Error message for the build in validators.
{x} gets swapped out with arguments form the validator.</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-keyword">var</span> defaultMessages = Validation.messages = {
    required: <span class="hljs-string">'{0} is required'</span>,
    acceptance: <span class="hljs-string">'{0} must be accepted'</span>,
    min: <span class="hljs-string">'{0} must be greater than or equal to {1}'</span>,
    max: <span class="hljs-string">'{0} must be less than or equal to {1}'</span>,
    range: <span class="hljs-string">'{0} must be between {1} and {2}'</span>,
    length: <span class="hljs-string">'{0} must be {1} characters'</span>,
    minLength: <span class="hljs-string">'{0} must be at least {1} characters'</span>,
    maxLength: <span class="hljs-string">'{0} must be at most {1} characters'</span>,
    rangeLength: <span class="hljs-string">'{0} must be between {1} and {2} characters'</span>,
    oneOf: <span class="hljs-string">'{0} must be one of: {1}'</span>,
    equalTo: <span class="hljs-string">'{0} must be the same as {1}'</span>,
    digits: <span class="hljs-string">'{0} must only contain digits'</span>,
    number: <span class="hljs-string">'{0} must be a number'</span>,
    email: <span class="hljs-string">'{0} must be a valid email'</span>,
    url: <span class="hljs-string">'{0} must be a valid url'</span>,
    inlinePattern: <span class="hljs-string">'{0} is invalid'</span>
  };</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="label-formatters">Label formatters</h2></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Label formatters are used to convert the attribute name
to a more human friendly label when using the built in
error messages.
Configure which one to use with a call to
    Backbone.Validation.configure({
      labelFormatter: &#39;label&#39;
    });</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-keyword">var</span> defaultLabelFormatters = Validation.labelFormatters = {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Returns the attribute name with applying any formatting</p></div></div><div class="code"><div class="wrapper">    none: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(attrName)</span> {</span>
      <span class="hljs-keyword">return</span> attrName;
    },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Converts attributeName or attribute_name to Attribute name</p></div></div><div class="code"><div class="wrapper">    sentenceCase: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(attrName)</span> {</span>
      <span class="hljs-keyword">return</span> attrName.replace(<span class="hljs-regexp">/(?:^\w|[A-Z]|\b\w)/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(match, index)</span> {</span>
        <span class="hljs-keyword">return</span> index === <span class="hljs-number">0</span> ? match.toUpperCase() : <span class="hljs-string">' '</span> + match.toLowerCase();
      }).replace(<span class="hljs-regexp">/_/g</span>, <span class="hljs-string">' '</span>);
    },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Looks for a label configured on the model and returns it
     var Model = Backbone.Model.extend({
       validation: {
         someAttribute: {
           required: true
         }
       },
       labels: {
         someAttribute: &#39;Custom label&#39;
       }
     });</p></div></div><div class="code"><div class="wrapper">    label: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(attrName, model)</span> {</span>
      <span class="hljs-keyword">return</span> (model.labels &amp;&amp; model.labels[attrName]) || defaultLabelFormatters.sentenceCase(attrName, model);
    }
  };</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="built-in-validators">Built in validators</h2></div></div></div><div class="segment"><div class="code"><div class="wrapper">  <span class="hljs-keyword">var</span> defaultValidators = Validation.validators = (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Use native trim when defined</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">var</span> trim = <span class="hljs-built_in">String</span>.prototype.trim ?
      <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(text)</span> {</span>
        <span class="hljs-keyword">return</span> text === <span class="hljs-literal">null</span> ? <span class="hljs-string">''</span> : <span class="hljs-built_in">String</span>.prototype.trim.call(text);
      } :
      <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(text)</span> {</span>
        <span class="hljs-keyword">var</span> trimLeft = <span class="hljs-regexp">/^\s+/</span>,
            trimRight = <span class="hljs-regexp">/\s+$/</span>;

        <span class="hljs-keyword">return</span> text === <span class="hljs-literal">null</span> ? <span class="hljs-string">''</span> : text.toString().replace(trimLeft, <span class="hljs-string">''</span>).replace(trimRight, <span class="hljs-string">''</span>);
      };</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Determines whether or not a value is a number</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">var</span> isNumber = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(value)</span>{</span>
      <span class="hljs-keyword">return</span> _.isNumber(value) || (_.isString(value) &amp;&amp; value.match(defaultPatterns.number));
    };</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Determines whether or not a value is empty</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">var</span> hasValue = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(value)</span> {</span>
      <span class="hljs-keyword">return</span> !(_.isNull(value) || _.isUndefined(value) || (_.isString(value) &amp;&amp; trim(value) === <span class="hljs-string">''</span>) || (_.isArray(value) &amp;&amp; _.isEmpty(value)));
    };

    <span class="hljs-keyword">return</span> {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Function validator
Lets you implement a custom function used for validation</p></div></div><div class="code"><div class="wrapper">      fn: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(value, attr, fn, model, computed)</span> {</span>
        <span class="hljs-keyword">if</span>(_.isString(fn)){
          fn = model[fn];
        }
        <span class="hljs-keyword">return</span> fn.call(model, value, attr, computed);
      },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Required validator
Validates if the attribute is required or not
This can be specified as either a boolean value or a function that returns a boolean value</p></div></div><div class="code"><div class="wrapper">      required: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(value, attr, required, model, computed)</span> {</span>
        <span class="hljs-keyword">var</span> isRequired = _.isFunction(required) ? required.call(model, value, attr, computed) : required;
        <span class="hljs-keyword">if</span>(!isRequired &amp;&amp; !hasValue(value)) {
          <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// overrides all other validators</span>
        }
        <span class="hljs-keyword">if</span> (isRequired &amp;&amp; !hasValue(value)) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format(defaultMessages.required, <span class="hljs-keyword">this</span>.formatLabel(attr, model));
        }
      },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Acceptance validator
Validates that something has to be accepted, e.g. terms of use
<code>true</code> or &#39;true&#39; are valid</p></div></div><div class="code"><div class="wrapper">      acceptance: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(value, attr, accept, model)</span> {</span>
        <span class="hljs-keyword">if</span>(value !== <span class="hljs-string">'true'</span> &amp;&amp; (!_.isBoolean(value) || value === <span class="hljs-literal">false</span>)) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format(defaultMessages.acceptance, <span class="hljs-keyword">this</span>.formatLabel(attr, model));
        }
      },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Min validator
Validates that the value has to be a number and equal to or greater than
the min value specified</p></div></div><div class="code"><div class="wrapper">      min: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(value, attr, minValue, model)</span> {</span>
        <span class="hljs-keyword">if</span> (!isNumber(value) || value &lt; minValue) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format(defaultMessages.min, <span class="hljs-keyword">this</span>.formatLabel(attr, model), minValue);
        }
      },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Max validator
Validates that the value has to be a number and equal to or less than
the max value specified</p></div></div><div class="code"><div class="wrapper">      max: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(value, attr, maxValue, model)</span> {</span>
        <span class="hljs-keyword">if</span> (!isNumber(value) || value &gt; maxValue) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format(defaultMessages.max, <span class="hljs-keyword">this</span>.formatLabel(attr, model), maxValue);
        }
      },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Range validator
Validates that the value has to be a number and equal to or between
the two numbers specified</p></div></div><div class="code"><div class="wrapper">      range: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(value, attr, range, model)</span> {</span>
        <span class="hljs-keyword">if</span>(!isNumber(value) || value &lt; range[<span class="hljs-number">0</span>] || value &gt; range[<span class="hljs-number">1</span>]) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format(defaultMessages.range, <span class="hljs-keyword">this</span>.formatLabel(attr, model), range[<span class="hljs-number">0</span>], range[<span class="hljs-number">1</span>]);
        }
      },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Length validator
Validates that the value has to be a string with length equal to
the length value specified</p></div></div><div class="code"><div class="wrapper">      length: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(value, attr, length, model)</span> {</span>
        <span class="hljs-keyword">if</span> (!_.isString(value) || value.length !== length) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format(defaultMessages.length, <span class="hljs-keyword">this</span>.formatLabel(attr, model), length);
        }
      },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Min length validator
Validates that the value has to be a string with length equal to or greater than
the min length value specified</p></div></div><div class="code"><div class="wrapper">      minLength: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(value, attr, minLength, model)</span> {</span>
        <span class="hljs-keyword">if</span> (!_.isString(value) || value.length &lt; minLength) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format(defaultMessages.minLength, <span class="hljs-keyword">this</span>.formatLabel(attr, model), minLength);
        }
      },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Max length validator
Validates that the value has to be a string with length equal to or less than
the max length value specified</p></div></div><div class="code"><div class="wrapper">      maxLength: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(value, attr, maxLength, model)</span> {</span>
        <span class="hljs-keyword">if</span> (!_.isString(value) || value.length &gt; maxLength) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format(defaultMessages.maxLength, <span class="hljs-keyword">this</span>.formatLabel(attr, model), maxLength);
        }
      },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Range length validator
Validates that the value has to be a string and equal to or between
the two numbers specified</p></div></div><div class="code"><div class="wrapper">      rangeLength: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(value, attr, range, model)</span> {</span>
        <span class="hljs-keyword">if</span> (!_.isString(value) || value.length &lt; range[<span class="hljs-number">0</span>] || value.length &gt; range[<span class="hljs-number">1</span>]) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format(defaultMessages.rangeLength, <span class="hljs-keyword">this</span>.formatLabel(attr, model), range[<span class="hljs-number">0</span>], range[<span class="hljs-number">1</span>]);
        }
      },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>One of validator
Validates that the value has to be equal to one of the elements in
the specified array. Case sensitive matching</p></div></div><div class="code"><div class="wrapper">      oneOf: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(value, attr, values, model)</span> {</span>
        <span class="hljs-keyword">if</span>(!_.include(values, value)){
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format(defaultMessages.oneOf, <span class="hljs-keyword">this</span>.formatLabel(attr, model), values.join(<span class="hljs-string">', '</span>));
        }
      },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Equal to validator
Validates that the value has to be equal to the value of the attribute
with the name specified</p></div></div><div class="code"><div class="wrapper">      equalTo: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(value, attr, equalTo, model, computed)</span> {</span>
        <span class="hljs-keyword">if</span>(value !== computed[equalTo]) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format(defaultMessages.equalTo, <span class="hljs-keyword">this</span>.formatLabel(attr, model), <span class="hljs-keyword">this</span>.formatLabel(equalTo, model));
        }
      },</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Pattern validator
Validates that the value has to match the pattern specified.
Can be a regular expression or the name of one of the built in patterns</p></div></div><div class="code"><div class="wrapper">      pattern: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(value, attr, pattern, model)</span> {</span>
        <span class="hljs-keyword">if</span> (!hasValue(value) || !value.toString().match(defaultPatterns[pattern] || pattern)) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format(defaultMessages[pattern] || defaultMessages.inlinePattern, <span class="hljs-keyword">this</span>.formatLabel(attr, model), pattern);
        }
      }
    };
  }());</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Set the correct context for all validators
when used from within a method validator</p></div></div><div class="code"><div class="wrapper">  _.each(defaultValidators, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(validator, key)</span>{</span>
    defaultValidators[key] = _.bind(defaultValidators[key], _.extend({}, formatFunctions, defaultValidators));
  });

  <span class="hljs-keyword">return</span> Validation;
}(_));</div></div></div></div></body></html>